# -*- coding: utf-8 -*-
## begin license ##
#
#    Meresco Components are components to build searchengines, repositories
#    and archives, based on Meresco Core.
#    Copyright (C) 2007-2008 SURF Foundation. http://www.surf.nl
#    Copyright (C) 2007-2009 Stichting Kennisnet Ict op school.
#       http://www.kennisnetictopschool.nl
#    Copyright (C) 2009 Delft University of Technology http://www.tudelft.nl
#    Copyright (C) 2009 Tilburg University http://www.uvt.nl
#    Copyright (C) 2007-2009 Seek You Too (CQ2) http://www.cq2.nl
#
#    This file is part of Meresco Components.
#
#    Meresco Components is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 2 of the License, or
#    (at your option) any later version.
#
#    Meresco Components is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with Meresco Components; if not, write to the Free Software
#    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
#
## end license ##

from tempfile import mkdtemp, gettempdir
from time import sleep
import os
from os.path import isfile, join
from os import listdir
from shutil import rmtree

from cq2utils import CQ2TestCase, CallTrace
from merescocomponents.facetindex import Document, IDFIELD, LuceneIndex

from merescocomponents.facetindex import CQL2LuceneQuery

from cqlparser import parseString

from PyLucene import Document as PyDocument, Field, IndexReader, IndexWriter, Term, TermQuery, MatchAllDocsQuery, JavaError
from weightless import Reactor

class LuceneAndTrackerTest(CQ2TestCase):

    def setUp(self):
        CQ2TestCase.setUp(self)
        self._luceneIndex = LuceneIndex(directoryName=self.tempdir)

    def tearDown(self):
        self._luceneIndex.close()
        CQ2TestCase.tearDown(self)

    def addDocument(self, identifier):
        doc = Document(identifier)
        doc.addIndexedField('field', 'needs value')
        self._luceneIndex.addDocument(doc)

    def commit(self):
        self._luceneIndex.commit()

    def testDocIdTrackerMismatch(self):
        #00001
        self.addDocument("application/pdf$")
        self.addDocument("2007$norm.date.year")
        self.addDocument("the$")
        self.addDocument("van$mods.name.namePart")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1588$meta.record.id")
        self.addDocument("van$")
        self.addDocument("lecture$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("pages$mods.abstract")
        self.addDocument("notes$")
        self.addDocument("lecture$mods.abstract")
        self.addDocument("of$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1588$")
        self.addDocument("true$")
        self.addDocument("pages$")
        self.addDocument("cover$mods.abstract")
        self.addDocument("content$mods.abstract")
        self.addDocument("10$")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("pdf$")
        self.addDocument("of$mods.abstract")
        self.addDocument("content$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1588$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("00$mods.titleInfo.title")
        self.addDocument("en-au$")
        self.addDocument("textbook$")
        self.addDocument("2000$")
        self.addDocument("00$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("eng$")
        self.addDocument("index$")
        self.addDocument("textbook$mods.abstract")
        self.addDocument("cover$")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("10$mods.abstract")
        self.addDocument("index$mods.abstract")
        self.addDocument("unknown$")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1588$")
        self.addDocument("and$")
        self.addDocument("mb$mods.abstract")
        self.addDocument("notes$mods.abstract")
        self.addDocument("content$mods.titleInfo.title")
        self.addDocument("2007-10-12$")
        self.addDocument("the$mods.abstract")
        self.addDocument("0.3$mods.abstract")
        self.addDocument("0.3$")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("and$mods.abstract")
        self.commit()
        #00002
        self.addDocument("liquid$")
        self.addDocument("2007$")
        self.addDocument("into$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1390$meta.record.id")
        self.addDocument("pipeline$")
        self.addDocument("van$")
        self.addDocument("index$mods.subject.topic")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("basic$mods.abstract")
        self.addDocument("pages$mods.abstract")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1390$")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("particles$")
        self.addDocument("flow$")
        self.addDocument("true$")
        self.addDocument("contents$mods.titleInfo.title")
        self.addDocument("text$")
        self.addDocument("unknown$")
        self.addDocument("into$mods.abstract")
        self.addDocument("pages$")
        self.addDocument("application/pdf$")
        self.addDocument("principles$mods.abstract")
        self.addDocument("12$mods.abstract")
        self.addDocument("willem$")
        self.addDocument("43$mods.abstract")
        self.addDocument("opencourseware$")
        self.addDocument("basic$")
        self.addDocument("2007-10-11$")
        self.addDocument("of$mods.abstract")
        self.addDocument("introduction$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("00$mods.titleInfo.title")
        self.addDocument("index$mods.abstract")
        self.addDocument("particles$mods.abstract")
        self.addDocument("2007$norm.date.year")
        self.addDocument("the$")
        self.addDocument("12$")
        self.addDocument("introduction$")
        self.addDocument("text$mods.abstract")
        self.addDocument("00$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("eng$")
        self.addDocument("index$")
        self.addDocument("2000$")
        self.addDocument("pdf$")
        self.addDocument("0.8$mods.abstract")
        self.addDocument("in$")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("in$mods.abstract")
        self.addDocument("liquid$mods.abstract")
        self.addDocument("0.8$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1390$")
        self.addDocument("of$")
        self.addDocument("and$")
        self.addDocument("43$")
        self.addDocument("flow$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1390$")
        self.addDocument("contents$")
        self.addDocument("en-au$")
        self.addDocument("pipeline$mods.abstract")
        self.addDocument("the$mods.abstract")
        self.addDocument("principles$")
        self.addDocument("and$mods.abstract")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00003
        self.addDocument("11$")
        self.addDocument("application/pdf$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1624$")
        self.addDocument("is$mods.abstract")
        self.addDocument("0.4$")
        self.addDocument("the$")
        self.addDocument("general$mods.abstract")
        self.addDocument("course$mods.abstract")
        self.addDocument("course$")
        self.addDocument("van$")
        self.addDocument("lecture$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1624$")
        self.addDocument("information$mods.titleInfo.title")
        self.addDocument("lecture$mods.abstract")
        self.addDocument("water$mods.abstract")
        self.addDocument("slides$")
        self.addDocument("unknown$")
        self.addDocument("explained$")
        self.addDocument("true$")
        self.addDocument("0.4$mods.abstract")
        self.addDocument("presentation$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1624$meta.record.id")
        self.addDocument("setup$")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("general$")
        self.addDocument("of$mods.abstract")
        self.addDocument("introduction$mods.abstract")
        self.addDocument("water$")
        self.addDocument("presentation$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("00$mods.titleInfo.title")
        self.addDocument("en-au$")
        self.addDocument("is$")
        self.addDocument("2007$norm.date.year")
        self.addDocument("2000$")
        self.addDocument("introduction$")
        self.addDocument("00$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("11$mods.abstract")
        self.addDocument("eng$")
        self.addDocument("on$")
        self.addDocument("explained$mods.abstract")
        self.addDocument("laboratorium$mods.abstract")
        self.addDocument("pdf$")
        self.addDocument("information$")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1624$")
        self.addDocument("in$")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("drinking$")
        self.addDocument("in$mods.abstract")
        self.addDocument("on$mods.abstract")
        self.addDocument("drinking$mods.abstract")
        self.addDocument("laboratorium$")
        self.addDocument("of$")
        self.addDocument("slides$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("general$mods.titleInfo.title")
        self.addDocument("setup$mods.abstract")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("2007-10-12$")
        self.addDocument("the$mods.abstract")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00004
        self.addDocument("more$mods.abstract")
        self.addDocument("is$mods.abstract")
        self.addDocument("the$")
        self.addDocument("general$mods.abstract")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1625$")
        self.addDocument("2000$")
        self.addDocument("van$")
        self.addDocument("given$")
        self.addDocument("information$mods.titleInfo.title")
        self.addDocument("1.4$")
        self.addDocument("text$mods.abstract")
        self.addDocument("information$mods.abstract")
        self.addDocument("true$")
        self.addDocument("application/pdf$")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("general$")
        self.addDocument("2007$norm.date.year")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("00$mods.titleInfo.title")
        self.addDocument("note$")
        self.addDocument("en-au$")
        self.addDocument("is$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1625$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1625$meta.record.id")
        self.addDocument("unknown$")
        self.addDocument("text$")
        self.addDocument("00$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("eng$")
        self.addDocument("pdf$")
        self.addDocument("note$mods.abstract")
        self.addDocument("more$")
        self.addDocument("information$")
        self.addDocument("in$")
        self.addDocument("given$mods.abstract")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("in$mods.abstract")
        self.addDocument("detail$")
        self.addDocument("pag$mods.abstract")
        self.addDocument("this$")
        self.addDocument("pag$")
        self.addDocument("mb$mods.abstract")
        self.addDocument("general$mods.titleInfo.title")
        self.addDocument("detail$mods.abstract")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("2007-10-12$")
        self.addDocument("this$mods.abstract")
        self.addDocument("the$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1625$")
        self.addDocument("1.4$mods.abstract")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00005
        self.addDocument("msc-starters$mods.abstract")
        self.addDocument("01$")
        self.addDocument("delft$")
        self.addDocument("welcome$")
        self.addDocument("is$mods.abstract")
        self.addDocument("given$")
        self.addDocument("new$")
        self.addDocument("for$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1566$")
        self.addDocument("van$")
        self.addDocument("lecture$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("33$")
        self.addDocument("eng$")
        self.addDocument("opencourseware$")
        self.addDocument("lecture$mods.abstract")
        self.addDocument("slides$")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1566$")
        self.addDocument("unknown$")
        self.addDocument("msc-starters$")
        self.addDocument("true$")
        self.addDocument("presentation$mods.abstract")
        self.addDocument("for$mods.abstract")
        self.addDocument("to$mods.abstract")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1566$meta.record.id")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("introduction$mods.abstract")
        self.addDocument("presentation$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("first$mods.abstract")
        self.addDocument("en-au$")
        self.addDocument("is$")
        self.addDocument("an$")
        self.addDocument("2000$")
        self.addDocument("an$mods.abstract")
        self.addDocument("introduction$")
        self.addDocument("application/pdf$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("students$mods.abstract")
        self.addDocument("first$")
        self.addDocument("pdf$")
        self.addDocument("welcome$mods.abstract")
        self.addDocument("to$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("2007$norm.date.year")
        self.addDocument("in$")
        self.addDocument("given$mods.abstract")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("in$mods.abstract")
        self.addDocument("3.0$mods.abstract")
        self.addDocument("3.0$")
        self.addDocument("this$")
        self.addDocument("slides$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("students$")
        self.addDocument("33$mods.abstract")
        self.addDocument("delft$mods.abstract")
        self.addDocument("new$mods.abstract")
        self.addDocument("2007-10-12$")
        self.addDocument("this$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1566$")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00006
        self.addDocument("msc-starters$mods.abstract")
        self.addDocument("01$")
        self.addDocument("delft$")
        self.addDocument("welcome$")
        self.addDocument("is$mods.abstract")
        self.addDocument("given$")
        self.addDocument("new$")
        self.addDocument("for$")
        self.addDocument("van$")
        self.addDocument("lecture$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("33$")
        self.addDocument("eng$")
        self.addDocument("lecture$mods.abstract")
        self.addDocument("slides$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1273$meta.record.id")
        self.addDocument("unknown$")
        self.addDocument("msc-starters$")
        self.addDocument("true$")
        self.addDocument("presentation$mods.abstract")
        self.addDocument("for$mods.abstract")
        self.addDocument("to$mods.abstract")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("introduction$mods.abstract")
        self.addDocument("presentation$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("first$mods.abstract")
        self.addDocument("en-au$")
        self.addDocument("is$")
        self.addDocument("an$")
        self.addDocument("2000$")
        self.addDocument("an$mods.abstract")
        self.addDocument("introduction$")
        self.addDocument("application/pdf$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1273$")
        self.addDocument("students$mods.abstract")
        self.addDocument("first$")
        self.addDocument("pdf$")
        self.addDocument("welcome$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1273$")
        self.addDocument("to$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("2007$norm.date.year")
        self.addDocument("in$")
        self.addDocument("given$mods.abstract")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("in$mods.abstract")
        self.addDocument("3.0$mods.abstract")
        self.addDocument("3.0$")
        self.addDocument("this$")
        self.addDocument("slides$mods.abstract")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1273$")
        self.addDocument("mb$mods.abstract")
        self.addDocument("students$")
        self.addDocument("33$mods.abstract")
        self.addDocument("delft$mods.abstract")
        self.addDocument("new$mods.abstract")
        self.addDocument("2007-10-12$")
        self.addDocument("this$mods.abstract")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00007
        self.addDocument("msc-starters$mods.abstract")
        self.addDocument("01$")
        self.addDocument("delft$")
        self.addDocument("welcome$")
        self.addDocument("is$mods.abstract")
        self.addDocument("given$")
        self.addDocument("new$")
        self.addDocument("for$")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1272$")
        self.addDocument("van$")
        self.addDocument("lecture$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("33$")
        self.addDocument("eng$")
        self.addDocument("lecture$mods.abstract")
        self.addDocument("slides$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1272$")
        self.addDocument("unknown$")
        self.addDocument("msc-starters$")
        self.addDocument("true$")
        self.addDocument("presentation$mods.abstract")
        self.addDocument("for$mods.abstract")
        self.addDocument("to$mods.abstract")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("introduction$mods.abstract")
        self.addDocument("presentation$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("first$mods.abstract")
        self.addDocument("en-au$")
        self.addDocument("is$")
        self.addDocument("an$")
        self.addDocument("2000$")
        self.addDocument("an$mods.abstract")
        self.addDocument("introduction$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1272$")
        self.addDocument("application/pdf$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("students$mods.abstract")
        self.addDocument("first$")
        self.addDocument("pdf$")
        self.addDocument("welcome$mods.abstract")
        self.addDocument("to$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("2007$norm.date.year")
        self.addDocument("in$")
        self.addDocument("given$mods.abstract")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("in$mods.abstract")
        self.addDocument("3.0$mods.abstract")
        self.addDocument("3.0$")
        self.addDocument("this$")
        self.addDocument("slides$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("students$")
        self.addDocument("33$mods.abstract")
        self.addDocument("delft$mods.abstract")
        self.addDocument("new$mods.abstract")
        self.addDocument("2007-10-12$")
        self.addDocument("this$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1272$meta.record.id")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00008
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1305$")
        self.addDocument("msc-starters$mods.abstract")
        self.addDocument("01$")
        self.addDocument("delft$")
        self.addDocument("welcome$")
        self.addDocument("is$mods.abstract")
        self.addDocument("given$")
        self.addDocument("new$")
        self.addDocument("for$")
        self.addDocument("van$")
        self.addDocument("lecture$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("33$")
        self.addDocument("eng$")
        self.addDocument("lecture$mods.abstract")
        self.addDocument("slides$")
        self.addDocument("unknown$")
        self.addDocument("msc-starters$")
        self.addDocument("true$")
        self.addDocument("presentation$mods.abstract")
        self.addDocument("for$mods.abstract")
        self.addDocument("to$mods.abstract")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("introduction$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1305$")
        self.addDocument("presentation$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("first$mods.abstract")
        self.addDocument("en-au$")
        self.addDocument("is$")
        self.addDocument("an$")
        self.addDocument("2000$")
        self.addDocument("an$mods.abstract")
        self.addDocument("introduction$")
        self.addDocument("application/pdf$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("students$mods.abstract")
        self.addDocument("first$")
        self.addDocument("pdf$")
        self.addDocument("welcome$mods.abstract")
        self.addDocument("to$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("2007$norm.date.year")
        self.addDocument("in$")
        self.addDocument("given$mods.abstract")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("in$mods.abstract")
        self.addDocument("3.0$mods.abstract")
        self.addDocument("3.0$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1305$meta.record.id")
        self.addDocument("this$")
        self.addDocument("slides$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("students$")
        self.addDocument("33$mods.abstract")
        self.addDocument("delft$mods.abstract")
        self.addDocument("new$mods.abstract")
        self.addDocument("2007-10-12$")
        self.addDocument("this$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1305$")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00009
        self.addDocument("particles$mods.titleInfo.title")
        self.addDocument("liquid$")
        self.addDocument("01$")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1399$")
        self.addDocument("18$")
        self.addDocument("2007$norm.date.year")
        self.addDocument("flow$mods.titleInfo.title")
        self.addDocument("the$")
        self.addDocument("will$mods.abstract")
        self.addDocument("opencourseware$")
        self.addDocument("pipeline$")
        self.addDocument("van$")
        self.addDocument("flow$")
        self.addDocument("pages$mods.abstract")
        self.addDocument("pipeline$mods.abstract")
        self.addDocument("discuss$mods.abstract")
        self.addDocument("chapter$mods.abstract")
        self.addDocument("discuss$")
        self.addDocument("ims_1_3$")
        self.addDocument("text$mods.abstract")
        self.addDocument("of$")
        self.addDocument("of$mods.titleInfo.title")
        self.addDocument("true$")
        self.addDocument("pages$")
        self.addDocument("application/pdf$")
        self.addDocument("2007$")
        self.addDocument("in$mods.titleInfo.title")
        self.addDocument("willem$")
        self.addDocument("principles$mods.abstract")
        self.addDocument("of$mods.abstract")
        self.addDocument("basic$")
        self.addDocument("2007-10-11$")
        self.addDocument("18$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1399$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1399$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1399$meta.record.id")
        self.addDocument("en-au$")
        self.addDocument("particles$mods.abstract")
        self.addDocument("2000$")
        self.addDocument("basic$mods.abstract")
        self.addDocument("particles$")
        self.addDocument("text$")
        self.addDocument("0.7$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("eng$")
        self.addDocument("pdf$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("0.7$mods.abstract")
        self.addDocument("this$")
        self.addDocument("in$")
        self.addDocument("chapter$")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("in$mods.abstract")
        self.addDocument("basic$mods.titleInfo.title")
        self.addDocument("pipeline$mods.titleInfo.title")
        self.addDocument("unknown$")
        self.addDocument("and$mods.titleInfo.title")
        self.addDocument("we$")
        self.addDocument("and$")
        self.addDocument("flow$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("principles$mods.titleInfo.title")
        self.addDocument("tud$")
        self.addDocument("liquid$mods.titleInfo.title")
        self.addDocument("we$mods.abstract")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("this$mods.abstract")
        self.addDocument("the$mods.abstract")
        self.addDocument("principles$")
        self.addDocument("and$mods.abstract")
        self.addDocument("liquid$mods.abstract")
        self.addDocument("will$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00010
        self.addDocument("coagulation$mods.titleInfo.title")
        self.addDocument("01$")
        self.addDocument("test$mods.abstract")
        self.addDocument("2007$norm.date.year")
        self.addDocument("the$")
        self.addDocument("van$mods.name.namePart")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1626$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("coagulation$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1626$")
        self.addDocument("van$")
        self.addDocument("unknown$")
        self.addDocument("flocculation$mods.titleInfo.title")
        self.addDocument("true$")
        self.addDocument("test$mods.titleInfo.title")
        self.addDocument("experiment$mods.abstract")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("jar$mods.abstract")
        self.addDocument("1.0$mods.abstract")
        self.addDocument("en-au$")
        self.addDocument("1.0$")
        self.addDocument("coagulation$")
        self.addDocument("2000$")
        self.addDocument("experiment$")
        self.addDocument("application/pdf$")
        self.addDocument("flocculation$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("eng$")
        self.addDocument("laboratorium$")
        self.addDocument("on$")
        self.addDocument("laboratorium$mods.abstract")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("pdf$")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("flocculation$mods.abstract")
        self.addDocument("on$mods.abstract")
        self.addDocument("jar$mods.titleInfo.title")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1626$meta.record.id")
        self.addDocument("and$mods.titleInfo.title")
        self.addDocument("and$")
        self.addDocument("mb$mods.abstract")
        self.addDocument("jar$")
        self.addDocument("mb$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("2007-10-12$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1626$")
        self.addDocument("the$mods.abstract")
        self.addDocument("opencourseware$")
        self.addDocument("and$mods.abstract")
        self.addDocument("ims_1_3$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("test$")
        self.commit()
        #00011
        self.addDocument("fundamental$mods.titleInfo.title")
        self.addDocument("discusses$mods.abstract")
        self.addDocument("required$mods.titleInfo.title")
        self.addDocument("01$")
        self.addDocument("circle$mods.abstract")
        self.addDocument("amongst$")
        self.addDocument("65$mods.abstract")
        self.addDocument("the$")
        self.addDocument("amongst$mods.abstract")
        self.addDocument("for$")
        self.addDocument("others$")
        self.addDocument("2000$")
        self.addDocument("0.6$mods.abstract")
        self.addDocument("van$")
        self.addDocument("circle$")
        self.addDocument("0.6$")
        self.addDocument("pages$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1427$")
        self.addDocument("fundamental$")
        self.addDocument("65$")
        self.addDocument("others$mods.abstract")
        self.addDocument("theory$mods.titleInfo.title")
        self.addDocument("unknown$")
        self.addDocument("mohr$")
        self.addDocument("true$")
        self.addDocument("theory$")
        self.addDocument("2007$norm.date.year")
        self.addDocument("tud$")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("general$")
        self.addDocument("rock$mods.titleInfo.title")
        self.addDocument("rock$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("note$")
        self.addDocument("en-au$")
        self.addDocument("2007-10-11$")
        self.addDocument("sand$mods.titleInfo.title")
        self.addDocument("sand$")
        self.addDocument("required$")
        self.addDocument("text$")
        self.addDocument("application/pdf$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("clay$mods.titleInfo.title")
        self.addDocument("eng$")
        self.addDocument("pdf$")
        self.addDocument("note$mods.abstract")
        self.addDocument("cutting$")
        self.addDocument("clay$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("mohr$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1427$")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("for$mods.titleInfo.title")
        self.addDocument("this$")
        self.addDocument("and$mods.titleInfo.title")
        self.addDocument("text$mods.abstract")
        self.addDocument("and$")
        self.addDocument("mb$mods.abstract")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1427$")
        self.addDocument("general$mods.titleInfo.title")
        self.addDocument("cutting$mods.titleInfo.title")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("this$mods.abstract")
        self.addDocument("discusses$")
        self.addDocument("the$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1427$meta.record.id")
        self.addDocument("ims_1_3$")
        self.addDocument("pages$")
        self.addDocument("valkenburg$")
        self.addDocument("van$mods.name.namePart")
        self.commit()
        #00012
        self.addDocument("chapt$")
        self.addDocument("4.1;2;3;4$mods.abstract")
        self.addDocument("and$mods.abstract")
        self.addDocument("01$")
        self.addDocument("synthesis$mods.titleInfo.title")
        self.addDocument("textbook$")
        self.addDocument("the$")
        self.addDocument("synthesis$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1449$")
        self.addDocument("course$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1449$meta.record.id")
        self.addDocument("true$")
        self.addDocument("van$mods.name.namePart")
        self.addDocument("lecture$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("with$mods.abstract")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("chapter$mods.abstract")
        self.addDocument("slides$")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1449$")
        self.addDocument("ims_1_3$")
        self.addDocument("unknown$")
        self.addDocument("modeling$mods.titleInfo.title")
        self.addDocument("presentation$mods.abstract")
        self.addDocument("to$mods.abstract")
        self.addDocument("willem$")
        self.addDocument("2007$")
        self.addDocument("opencourseware$")
        self.addDocument("modeling$")
        self.addDocument("of$mods.abstract")
        self.addDocument("introduction$mods.abstract")
        self.addDocument("presentation$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("course$")
        self.addDocument("deals$")
        self.addDocument("en-au$")
        self.addDocument("deals$mods.abstract")
        self.addDocument("chapt$mods.abstract")
        self.addDocument("2000$")
        self.addDocument("introduction$")
        self.addDocument("0.35$mods.abstract")
        self.addDocument("application/pdf$")
        self.addDocument("mb$")
        self.addDocument("willem$mods.name.namePart")
        self.addDocument("eng$")
        self.addDocument("pdf$")
        self.addDocument("modeling$mods.abstract")
        self.addDocument("2007-10-11$")
        self.addDocument("to$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("textbook$mods.abstract")
        self.addDocument("2007$norm.date.year")
        self.addDocument("chapter$")
        self.addDocument("valkenburg$mods.name.namePart")
        self.addDocument("61$mods.abstract")
        self.addDocument("61$")
        self.addDocument("4.1;2;3;4$")
        self.addDocument("0.35$")
        self.addDocument("this$")
        self.addDocument("of$")
        self.addDocument("and$")
        self.addDocument("slides$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("lecture$mods.abstract")
        self.addDocument("architectural$mods.titleInfo.title")
        self.addDocument("with$")
        self.addDocument("this$mods.abstract")
        self.addDocument("the$mods.abstract")
        self.addDocument("architectural$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1449$")
        self.addDocument("tud$")
        self.addDocument("valkenburg$")
        self.addDocument("van$")
        self.commit()
        #00013
        self.addDocument("application/pdf$")
        self.addDocument("01$")
        self.addDocument("mantel$mods.name.namePart")
        self.addDocument("liesbeth$")
        self.addDocument("2007$norm.date.year")
        self.addDocument("the$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1406$")
        self.addDocument("transform$")
        self.addDocument("tud$")
        self.addDocument("discrete$")
        self.addDocument("2000$")
        self.addDocument("ims_1_3$")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("0.88$mods.abstract")
        self.addDocument("0.88$")
        self.addDocument("opencourseware$")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("slides$")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1406$")
        self.addDocument("dft$mods.titleInfo.title")
        self.addDocument("unknown$")
        self.addDocument("true$")
        self.addDocument("presentation$mods.abstract")
        self.addDocument("2007$")
        self.addDocument("liesbeth$mods.name.namePart")
        self.addDocument("presentation$")
        self.addDocument("transform$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("4.1-4.7$mods.abstract")
        self.addDocument("en-au$")
        self.addDocument("2007-10-11$")
        self.addDocument("fourier$mods.abstract")
        self.addDocument("porat$mods.abstract")
        self.addDocument("17$")
        self.addDocument("the$mods.titleInfo.title")
        self.addDocument("introduction$")
        self.addDocument("4.1-4.7$")
        self.addDocument("mb$")
        self.addDocument("mantel$")
        self.addDocument("eng$")
        self.addDocument("pdf$")
        self.addDocument("porat$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("the$mods.abstract")
        self.addDocument("fourier$")
        self.addDocument("course$mods.titleInfo.title")
        self.addDocument("dft$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1406$")
        self.addDocument("course$")
        self.addDocument("slides$mods.abstract")
        self.addDocument("and$")
        self.addDocument("mb$mods.abstract")
        self.addDocument("principles$mods.titleInfo.title")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1406$meta.record.id")
        self.addDocument("discrete$mods.abstract")
        self.addDocument("to$mods.titleInfo.title")
        self.addDocument("principles$")
        self.addDocument("17$mods.abstract")
        self.addDocument("to$")
        self.addDocument("and$mods.abstract")
        self.commit()
        #00014
        self.addDocument("01$")
        self.addDocument("mantel$mods.name.namePart")
        self.addDocument("liesbeth$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1409$")
        self.addDocument("2007$norm.date.year")
        self.addDocument("the$")
        self.addDocument("ims_1_3$")
        self.addDocument("explanation$mods.abstract")
        self.addDocument("pages$mods.abstract")
        self.addDocument("opencourseware$")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("extra$")
        self.addDocument("dft$mods.titleInfo.title")
        self.addDocument("unknown$")
        self.addDocument("true$")
        self.addDocument("pages$")
        self.addDocument("explanation$")
        self.addDocument("notes$")
        self.addDocument("2007$")
        self.addDocument("liesbeth$mods.name.namePart")
        self.addDocument("http://digirep.tudelft.nl/hive/quickfetch.html?viewtype=original&idtype=alias&id=1409$")
        self.addDocument("0.13$mods.abstract")
        self.addDocument("en-au$")
        self.addDocument("2007-10-11$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1409$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1409$meta.record.id")
        self.addDocument("2000$")
        self.addDocument("the$mods.titleInfo.title")
        self.addDocument("introduction$")
        self.addDocument("text$")
        self.addDocument("application/pdf$")
        self.addDocument("mb$")
        self.addDocument("mantel$")
        self.addDocument("eng$")
        self.addDocument("pdf$")
        self.addDocument("01$mods.titleInfo.title")
        self.addDocument("extra$mods.abstract")
        self.addDocument("0.13$")
        self.addDocument("in$")
        self.addDocument("course$mods.titleInfo.title")
        self.addDocument("in$mods.abstract")
        self.addDocument("dft$")
        self.addDocument("this$")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("course$")
        self.addDocument("text$mods.abstract")
        self.addDocument("mb$mods.abstract")
        self.addDocument("principles$mods.titleInfo.title")
        self.addDocument("notes$mods.abstract")
        self.addDocument("pdf$mods.abstract")
        self.addDocument("this$mods.abstract")
        self.addDocument("to$mods.titleInfo.title")
        self.addDocument("principles$")
        self.addDocument("tud$")
        self.addDocument("to$")
        self.commit()
        #00015
        self.addDocument("01$")
        self.addDocument("mantel$mods.name.namePart")
        self.addDocument("liesbeth$")
        self.addDocument("mb$mods.abstract")
        self.addDocument("the$")
        self.addDocument("properties$mods.abstract")
        self.addDocument("summary$")
        self.addDocument("opencourseware:oai:hiveacs.tudelft.nl/hii:1411$")
        self.addDocument("important$mods.abstract")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1411$")
        self.addDocument("14$mods.abstract")
        self.addDocument("pages$mods.abstract")
        self.addDocument("introduction$mods.titleInfo.title")
        self.addDocument("important$")
        self.addDocument("dft$mods.titleInfo.title")
        self.addDocument("unknown$")
        self.addDocument("true$")
        self.addDocument("pages$")
        self.addDocument("oai:hiveacs.tudelft.nl/hii:1411$meta.record.id")
        self.addDocument("mb$")
        self.addDocument("2007$")
        self.addDocument("liesbeth$mods.name.namePart")
        self.addDocument("on$mods.abstract")
        self.addDocument("of$mods.abstract")
        self.addDocument("2007$norm.date.year")
        self.addDocument("transform$mods.abstract")
        self.addDocument("http://digirep.tudelft.nl/cgi-bin/hive/oai.cgi$")
        self.addDocument("note$")
        self.addDocument("en-au$")
        self.addDocument("2007-10-11$")
        self.addDocument("fourier$mods.abstract")
        self.addDocument("transform$")
        self.addDocument("2000$")
        self.addDocument("the$mods.titleInfo.title")
        self.addDocument("introduction$")
        self.addDocument("text$")
        self.addDocument("application/pdf$")
        self.addDocument("0.16$mods.abstract")
        self.addDocument("mantel$")
        self.addDocument("eng$")
        self.addDocument("on$")
